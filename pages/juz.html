<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Juz</title>

<link rel="stylesheet" href="../style.css">
</head>

<body>

<header class="app-header">
  <button onclick="history.back()">‚Üê</button>
  Juz
</header>

<main class="container">
  <div id="juzContent">Memuat juz...</div>
</main>

<script src="../data/juz-map.js"></script>
<script>
const juzNo = Number(new URLSearchParams(location.search).get('no'));
const juzContent = document.getElementById('juzContent');

const juzInfo = JUZ_MAP.find(j => j.juz === juzNo);

if (!juzInfo) {
  juzContent.innerHTML = '<p>Juz tidak valid</p>';
} else {
  loadJuz(juzInfo);
}

async function loadJuz({ start, end }) {
  juzContent.innerHTML = '';

  for (let surah = start[0]; surah <= end[0]; surah++) {
    try {
      const res = await fetch(`https://equran.id/api/v2/surat/${surah}`);
      const json = await res.json();

      json.data.ayat.forEach(a => {
        const ayatNo = a.nomorAyat;

        const isStartSurah = surah === start[0];
        const isEndSurah   = surah === end[0];

        if (
          (isStartSurah && ayatNo < start[1]) ||
          (isEndSurah && ayatNo > end[1])
        ) return;

        const el = document.createElement('div');
        el.className = 'ayat-item';
        el.innerHTML = `
          <p class="arab">${a.teksArab}</p>
          <p class="arti">${a.teksIndonesia}</p>
          <small>${json.data.namaLatin} : ${ayatNo}</small>
        `;
        juzContent.appendChild(el);
      });

    } catch (e) {
      juzContent.innerHTML = '<p>Gagal memuat juz</p>';
    }
  }
}
</script>

</body>
</html>