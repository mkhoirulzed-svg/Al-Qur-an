<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Juz</title>

<link rel="stylesheet" href="../style.css">
<style>
/* PAKSA TAMPIL (DEBUG) */
.ayat-item { margin-bottom: 16px; }
.arab { font-size: 22px; direction: rtl; }
.arti { font-size: 14px; color: #333; }
</style>
</head>

<body>

<header class="app-header">
  <button onclick="history.back()">‚Üê</button>
  Juz
</header>

<main class="container">
  <div id="juzContent">üîÑ Memuat juz...</div>
</main>

<script>
const juzNo = Number(new URLSearchParams(location.search).get('no'));
const juzContent = document.getElementById('juzContent');

if (!juzNo) {
  juzContent.innerHTML = '<p>‚ùå Juz tidak valid</p>';
  throw new Error("Juz invalid");
}

(async function loadJuz() {
  let count = 0;
  juzContent.innerHTML = '';

  for (let surah = 1; surah <= 114; surah++) {
    try {
      const res = await fetch(`https://equran.id/api/v2/surat/${surah}`);
      const json = await res.json();

      json.data.ayat.forEach(a => {
        if (a.juz === juzNo) {
          count++;
          const el = document.createElement('div');
          el.className = 'ayat-item';
          el.innerHTML = `
            <p class="arab">${a.teksArab}</p>
            <p class="arti">${a.teksIndonesia}</p>
            <small>${json.data.namaLatin} : ${a.nomorAyat}</small>
          `;
          juzContent.appendChild(el);
        }
      });

      // üî• render bertahap (anti blank)
      if (count > 0) {
        await new Promise(r => setTimeout(r, 0));
      }

    } catch (e) {
      console.error("Surah error:", surah);
    }
  }

  if (count === 0) {
    juzContent.innerHTML = '<p>‚ùå Tidak ada ayat ditemukan</p>';
  }
})();
</script>

</body>
</html>